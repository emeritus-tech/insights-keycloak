import{jsx as e,jsxs as m,Fragment as k}from"react/jsx-runtime";import{useState as I}from"react";import{u as T,a as V,d as B,g as K,c as j,f as E,w as x,ab as H,B as L,aS as v,a3 as N,D as O,P as q,F as U,y as P,A as $,j as h,L as z,aT as G}from"./main-DXDh8SEc.js";import{u as W}from"./ConfirmDialog-o8TAA2Kj.js";import{D as J}from"./DynamicComponents-oH6U-qv7.js";import{F as M}from"./FormAccess-Bcw0IOUQ.js";import{V as Q}from"./ViewHeader-DTd0a4sz.js";import{u as X}from"./useParams-5577fL9S.js";import"react-dom";import"./ClientSelect-DzH7E0lJ.js";import"./FileUpload-CK_LBb0x.js";import"./CodeEditor-BFrRAdAy.js";import"./copy-icon-C4kUIpk5.js";import"./EmptyStateFooter-C_ktbNPy.js";import"./EmptyStateActions-CiPKPOdJ.js";import"./GroupPickerDialog-B6DOUphD.js";import"./PaginatingTableToolbar-zbU1l_6-.js";import"./DataListItemRow-CavOLjhh.js";import"./FlexItem-c5qvFYFZ.js";import"./KeySelect-BIWWws15.js";import"./useToggle-K3Kx99tM.js";import"./MultiLineInput-D3_8dp6S.js";import"./AddRoleMappingModal-BqIKRo9T.js";import"./KeycloakDataTable-B3eTS_qk.js";import"./Td-BmSS9qQq.js";import"./grip-vertical-icon-CgFEKIXW.js";import"./_baseFlatten-CMLUuI8z.js";import"./filter-icon-Do5tIUfA.js";function we(){const{adminClient:n}=T(),{t}=V(),{id:r,providerId:s,subTab:c}=X(),d=B(),p=K({defaultValues:{providerId:s}}),{control:C,handleSubmit:b,reset:D}=p,{realm:l,realmRepresentation:R}=j(),{addAlert:u,addError:f}=E(),[y,S]=I();x(async()=>await Promise.all([n.realms.getClientRegistrationPolicyProviders({realm:l}),r?n.components.findOne({id:r}):Promise.resolve()]),([i,o])=>{S(i.find(a=>a.id===s)),D(o||{providerId:s})},[]);const g=H({control:C,defaultValue:"",name:"name"}),w=async i=>{i.config&&Object.entries(i.config).forEach(([o,a])=>i.config[o]=Array.isArray(a)?a:[a]);try{const o={...i,subType:c,parentId:R?.id,providerType:"org.keycloak.services.clientregistration.policy.ClientRegistrationPolicy",providerId:s};if(r)await n.components.update({id:r},o);else{const{id:a}=await n.components.create(o);d(G({id:a,realm:l,subTab:c,providerId:s}))}u(t(`provider${r?"Updated":"Create"}Success`))}catch(o){f(`provider${r?"Updated":"Create"}Error`,o)}},[A,F]=W({titleKey:"clientRegisterPolicyDeleteConfirmTitle",messageKey:t("clientRegisterPolicyDeleteConfirm",{name:g}),continueButtonLabel:"delete",continueButtonVariant:L.danger,onConfirm:async()=>{try{await n.components.del({realm:l,id:r}),u(t("clientRegisterPolicyDeleteSuccess")),d(v({realm:l,subTab:c}))}catch(i){f("clientRegisterPolicyDeleteError",i)}}});return y?m(k,{children:[e(Q,{titleKey:r?g:"createPolicy",subKey:r,dropdownItems:r?[e(O,{"data-testid":"delete",onClick:A,children:t("delete")},"delete")]:void 0}),e(F,{}),e(q,{variant:"light",children:e(U,{...p,children:m(M,{role:"manage-clients",isHorizontal:!0,onSubmit:b(w),children:[e(P,{name:"providerId",label:t("provider"),readOnly:!0}),e(P,{name:"name",label:t("name"),labelIcon:t("clientPolicyNameHelp"),rules:{required:t("required")}}),e(J,{properties:y.properties}),m($,{children:[e(h,{"data-testid":"save",type:"submit",children:t("save")}),e(h,{variant:"link",component:i=>e(z,{...i,to:v({realm:l,subTab:c})}),children:t("cancel")})]})]})})})]}):e(N,{})}export{we as default};
//# sourceMappingURL=DetailProvider-GCCSxW40.js.map
