{"version":3,"file":"UsersSection-C7eHzRvy.js","sources":["../../src/user/details/SearchFilter.tsx","../../src/components/users/UserDataTableAttributeSearchForm.tsx","../../src/components/users/UserDataTableToolbarItems.tsx","../../src/components/users/UserDataTable.tsx","../../src/user/UsersSection.tsx"],"sourcesContent":["import { KeycloakSelect } from \"@keycloak/keycloak-ui-shared\";\nimport {\n  Dropdown,\n  DropdownItem,\n  DropdownList,\n  MenuToggle,\n  SelectOption,\n  ToolbarItem,\n} from \"@patternfly/react-core\";\nimport { FilterIcon } from \"@patternfly/react-icons\";\nimport { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\n\nexport type SearchType = \"default\" | \"attribute\";\n\ntype SearchToolbarProps = SearchDropdownProps;\n\ntype SearchDropdownProps = {\n  searchType: SearchType;\n  onSelect: (value: SearchType) => void;\n};\n\nexport const SearchDropdown = ({\n  searchType,\n  onSelect,\n}: SearchDropdownProps) => {\n  const { t } = useTranslation();\n  const [searchToggle, setSearchToggle] = useState(false);\n\n  const createDropdown = (searchType: SearchType) => (\n    <DropdownItem\n      key={searchType}\n      onClick={() => {\n        onSelect(searchType);\n        setSearchToggle(false);\n      }}\n    >\n      {t(`searchType.${searchType}`)}\n    </DropdownItem>\n  );\n  const options = [createDropdown(\"default\"), createDropdown(\"attribute\")];\n\n  return (\n    <Dropdown\n      className=\"keycloak__users__searchtype\"\n      onOpenChange={(isOpen) => setSearchToggle(isOpen)}\n      toggle={(ref) => (\n        <MenuToggle\n          ref={ref}\n          id=\"toggle-id\"\n          onClick={() => setSearchToggle(!searchToggle)}\n          icon={<FilterIcon />}\n        >\n          {t(`searchType.${searchType}`)}\n        </MenuToggle>\n      )}\n      isOpen={searchToggle}\n    >\n      <DropdownList>{options}</DropdownList>\n    </Dropdown>\n  );\n};\n\nexport const SearchToolbar = ({ searchType, onSelect }: SearchToolbarProps) => {\n  const { t } = useTranslation();\n  const [open, setOpen] = useState(false);\n\n  return (\n    <>\n      <ToolbarItem>\n        <SearchDropdown searchType={searchType} onSelect={onSelect} />\n      </ToolbarItem>\n      <ToolbarItem>\n        <KeycloakSelect\n          className=\"keycloak__users__searchtype\"\n          onToggle={(val) => setOpen(val)}\n          isOpen={open}\n          selections={[t(\"default\"), t(\"attribute\")]}\n          onSelect={() => setOpen(false)}\n        >\n          <SelectOption value={\"default\"}>{t(\"default\")}</SelectOption>\n          <SelectOption value={\"attribute\"}>{t(\"attribute\")}</SelectOption>\n        </KeycloakSelect>\n      </ToolbarItem>\n    </>\n  );\n};\n","import type { UserProfileConfig } from \"@keycloak/keycloak-admin-client/lib/defs/userProfileMetadata\";\nimport {\n  KeycloakSelect,\n  SelectVariant,\n  label,\n} from \"@keycloak/keycloak-ui-shared\";\nimport {\n  ActionGroup,\n  Alert,\n  AlertVariant,\n  Button,\n  ButtonVariant,\n  InputGroup,\n  InputGroupItem,\n  SelectOption,\n  Text,\n  TextContent,\n  TextInput,\n  TextVariants,\n} from \"@patternfly/react-core\";\nimport { CheckIcon } from \"@patternfly/react-icons\";\nimport { ReactNode, useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { useTranslation } from \"react-i18next\";\nimport { Form } from \"react-router-dom\";\nimport { useAlerts } from \"../alert/Alerts\";\nimport { UserAttribute } from \"./UserDataTable\";\n\ntype UserDataTableAttributeSearchFormProps = {\n  activeFilters: UserAttribute[];\n  setActiveFilters: (filters: UserAttribute[]) => void;\n  profile: UserProfileConfig;\n  createAttributeSearchChips: () => ReactNode;\n  searchUserWithAttributes: () => void;\n};\n\nexport function UserDataTableAttributeSearchForm({\n  activeFilters,\n  setActiveFilters,\n  profile,\n  createAttributeSearchChips,\n  searchUserWithAttributes,\n}: UserDataTableAttributeSearchFormProps) {\n  const { t } = useTranslation();\n  const { addAlert } = useAlerts();\n  const [selectAttributeKeyOpen, setSelectAttributeKeyOpen] = useState(false);\n\n  const defaultValues: UserAttribute = {\n    name: \"\",\n    displayName: \"\",\n    value: \"\",\n  };\n\n  const {\n    getValues,\n    register,\n    reset,\n    formState: { errors },\n    setValue,\n    setError,\n    clearErrors,\n  } = useForm<UserAttribute>({\n    mode: \"onChange\",\n    defaultValues,\n  });\n\n  const isAttributeKeyDuplicate = () => {\n    return activeFilters.some((filter) => filter.name === getValues().name);\n  };\n\n  const isAttributeNameValid = () => {\n    let valid = false;\n    if (!getValues().name.length) {\n      setError(\"name\", {\n        type: \"empty\",\n        message: t(\"searchUserByAttributeMissingKeyError\"),\n      });\n    } else if (\n      activeFilters.some((filter) => filter.name === getValues().name)\n    ) {\n      setError(\"name\", {\n        type: \"conflict\",\n        message: t(\"searchUserByAttributeKeyAlreadyInUseError\"),\n      });\n    } else {\n      valid = true;\n    }\n    return valid;\n  };\n\n  const isAttributeValueValid = () => {\n    let valid = false;\n    if (!getValues().value.length) {\n      setError(\"value\", {\n        type: \"empty\",\n        message: t(\"searchUserByAttributeMissingValueError\"),\n      });\n    } else {\n      valid = true;\n    }\n    return valid;\n  };\n\n  const isAttributeValid = () =>\n    isAttributeNameValid() && isAttributeValueValid();\n\n  const addToFilter = () => {\n    if (isAttributeValid()) {\n      setActiveFilters([\n        ...activeFilters,\n        {\n          ...getValues(),\n        },\n      ]);\n      reset();\n    } else {\n      errors.name?.message &&\n        addAlert(errors.name.message, AlertVariant.danger);\n      errors.value?.message &&\n        addAlert(errors.value.message, AlertVariant.danger);\n    }\n  };\n\n  const clearActiveFilters = () => {\n    const filtered = [...activeFilters].filter(\n      (chip) => chip.name !== chip.name,\n    );\n    setActiveFilters(filtered);\n  };\n\n  const createAttributeKeyInputField = () => {\n    if (profile) {\n      return (\n        <KeycloakSelect\n          data-testid=\"search-attribute-name\"\n          variant={SelectVariant.typeahead}\n          onToggle={(isOpen) => setSelectAttributeKeyOpen(isOpen)}\n          selections={getValues().displayName}\n          onSelect={(selectedValue) => {\n            setValue(\"displayName\", selectedValue.toString());\n            if (isAttributeKeyDuplicate()) {\n              setError(\"name\", { type: \"conflict\" });\n            } else {\n              clearErrors(\"name\");\n            }\n          }}\n          isOpen={selectAttributeKeyOpen}\n          placeholderText={t(\"selectAttribute\")}\n          validated={errors.name && \"error\"}\n          maxHeight={300}\n          {...register(\"displayName\", {\n            required: true,\n            validate: isAttributeNameValid,\n          })}\n        >\n          {profile.attributes?.map((option) => (\n            <SelectOption\n              key={option.name}\n              value={label(t, option.displayName!, option.name)}\n              onClick={(e) => {\n                e.stopPropagation();\n                setSelectAttributeKeyOpen(false);\n                setValue(\"name\", option.name!);\n              }}\n            >\n              {label(t, option.displayName!, option.name)}\n            </SelectOption>\n          ))}\n        </KeycloakSelect>\n      );\n    } else {\n      return (\n        <TextInput\n          id=\"name\"\n          placeholder={t(\"keyPlaceholder\")}\n          validated={errors.name && \"error\"}\n          onKeyDown={(e) => e.key === \"Enter\" && addToFilter()}\n          {...register(\"name\", {\n            required: true,\n            validate: isAttributeNameValid,\n          })}\n        />\n      );\n    }\n  };\n\n  return (\n    <Form className=\"user-attribute-search-form\">\n      <TextContent className=\"user-attribute-search-form-headline\">\n        <Text component={TextVariants.h2}>{t(\"selectAttributes\")}</Text>\n      </TextContent>\n      <Alert\n        isInline\n        className=\"user-attribute-search-form-alert\"\n        variant=\"info\"\n        title={t(\"searchUserByAttributeDescription\")}\n        component=\"h3\"\n      />\n      <TextContent className=\"user-attribute-search-form-key-value\">\n        <div className=\"user-attribute-search-form-left\">\n          <Text component={TextVariants.h3}>{t(\"key\")}</Text>\n        </div>\n        <div className=\"user-attribute-search-form-right\">\n          <Text component={TextVariants.h3}>{t(\"value\")}</Text>\n        </div>\n      </TextContent>\n      <div className=\"user-attribute-search-form-left\">\n        {createAttributeKeyInputField()}\n      </div>\n      <div className=\"user-attribute-search-form-right\">\n        <InputGroup>\n          <InputGroupItem>\n            <TextInput\n              id=\"value\"\n              placeholder={t(\"valuePlaceholder\")}\n              validated={errors.value && \"error\"}\n              onKeyDown={(e) => {\n                if (e.key === \"Enter\") {\n                  e.preventDefault();\n                  addToFilter();\n                }\n              }}\n              {...register(\"value\", {\n                required: true,\n                validate: isAttributeValueValid,\n              })}\n            />\n          </InputGroupItem>\n          <InputGroupItem>\n            <Button\n              variant=\"control\"\n              icon={<CheckIcon />}\n              onClick={addToFilter}\n              aria-label={t(\"addToFilter\")}\n            />\n          </InputGroupItem>\n        </InputGroup>\n      </div>\n      {createAttributeSearchChips()}\n      <ActionGroup className=\"user-attribute-search-form-action-group\">\n        <Button\n          data-testid=\"search-user-attribute-btn\"\n          variant=\"primary\"\n          type=\"submit\"\n          isDisabled={!activeFilters.length}\n          onClick={searchUserWithAttributes}\n        >\n          {t(\"search\")}\n        </Button>\n        <Button\n          variant={ButtonVariant.link}\n          onClick={() => {\n            reset();\n            clearActiveFilters();\n          }}\n        >\n          {t(\"reset\")}\n        </Button>\n      </ActionGroup>\n    </Form>\n  );\n}\n","import type RealmRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/realmRepresentation\";\nimport type { UserProfileConfig } from \"@keycloak/keycloak-admin-client/lib/defs/userProfileMetadata\";\nimport {\n  Button,\n  ButtonVariant,\n  InputGroup,\n  SearchInput,\n  ToolbarItem,\n  InputGroupItem,\n  Dropdown,\n  MenuToggle,\n  DropdownList,\n  DropdownItem,\n} from \"@patternfly/react-core\";\nimport { ArrowRightIcon, EllipsisVIcon } from \"@patternfly/react-icons\";\nimport { ReactNode, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\n\nimport { useAccess } from \"../../context/access/Access\";\nimport { SearchDropdown, SearchType } from \"../../user/details/SearchFilter\";\nimport { UserAttribute } from \"./UserDataTable\";\nimport { UserDataTableAttributeSearchForm } from \"./UserDataTableAttributeSearchForm\";\nimport DropdownPanel from \"../dropdown-panel/DropdownPanel\";\n\ntype UserDataTableToolbarItemsProps = {\n  searchDropdownOpen: boolean;\n  setSearchDropdownOpen: (open: boolean) => void;\n  realm: RealmRepresentation;\n  hasSelectedRows: boolean;\n  toggleDeleteDialog: () => void;\n  toggleUnlockUsersDialog: () => void;\n  goToCreate: () => void;\n  searchType: SearchType;\n  setSearchType: (searchType: SearchType) => void;\n  searchUser: string;\n  setSearchUser: (searchUser: string) => void;\n  activeFilters: UserAttribute[];\n  setActiveFilters: (activeFilters: UserAttribute[]) => void;\n  refresh: () => void;\n  profile: UserProfileConfig;\n  clearAllFilters: () => void;\n  createAttributeSearchChips: () => ReactNode;\n  searchUserWithAttributes: () => void;\n};\n\nexport function UserDataTableToolbarItems({\n  searchDropdownOpen,\n  setSearchDropdownOpen,\n  realm,\n  hasSelectedRows,\n  toggleDeleteDialog,\n  toggleUnlockUsersDialog,\n  goToCreate,\n  searchType,\n  setSearchType,\n  searchUser,\n  setSearchUser,\n  activeFilters,\n  setActiveFilters,\n  refresh,\n  profile,\n  clearAllFilters,\n  createAttributeSearchChips,\n  searchUserWithAttributes,\n}: UserDataTableToolbarItemsProps) {\n  const { t } = useTranslation();\n  const [kebabOpen, setKebabOpen] = useState(false);\n\n  const { hasAccess } = useAccess();\n\n  // Only needs query-users access to attempt add/delete of users.\n  // This is because the user could have fine-grained access to users\n  // of a group.  There is no way to know this without searching the\n  // permissions of every group.\n  const isManager = hasAccess(\"query-users\");\n\n  const searchItem = () => {\n    return (\n      <ToolbarItem>\n        <InputGroup>\n          <InputGroupItem>\n            <SearchDropdown\n              searchType={searchType}\n              onSelect={(searchType) => {\n                clearAllFilters();\n                setSearchType(searchType);\n              }}\n            />\n          </InputGroupItem>\n          {searchType === \"default\" && defaultSearchInput()}\n          {searchType === \"attribute\" && attributeSearchInput()}\n        </InputGroup>\n      </ToolbarItem>\n    );\n  };\n\n  const defaultSearchInput = () => {\n    return (\n      <ToolbarItem>\n        <SearchInput\n          data-testid=\"table-search-input\"\n          placeholder={t(\"searchForUser\")}\n          aria-label={t(\"search\")}\n          value={searchUser}\n          onSearch={(_, _v, attribute) => {\n            setSearchUser(attribute[\"haswords\"]);\n            refresh();\n          }}\n          onKeyDown={(e) => {\n            if (e.key === \"Enter\") {\n              const target = e.target as HTMLInputElement;\n              setSearchUser(target.value);\n              refresh();\n            }\n          }}\n          onClear={() => {\n            setSearchUser(\"\");\n            refresh();\n          }}\n        />\n      </ToolbarItem>\n    );\n  };\n\n  const attributeSearchInput = () => {\n    return (\n      <>\n        <DropdownPanel\n          buttonText={t(\"selectAttributes\")}\n          setSearchDropdownOpen={setSearchDropdownOpen}\n          searchDropdownOpen={searchDropdownOpen}\n          width=\"15vw\"\n        >\n          <UserDataTableAttributeSearchForm\n            activeFilters={activeFilters}\n            setActiveFilters={setActiveFilters}\n            profile={profile}\n            createAttributeSearchChips={createAttributeSearchChips}\n            searchUserWithAttributes={() => {\n              searchUserWithAttributes();\n              setSearchDropdownOpen(false);\n            }}\n          />\n        </DropdownPanel>\n        <Button\n          icon={<ArrowRightIcon />}\n          variant=\"control\"\n          onClick={() => {\n            searchUserWithAttributes();\n            setSearchDropdownOpen(false);\n          }}\n          aria-label={t(\"searchAttributes\")}\n        />\n      </>\n    );\n  };\n\n  const bruteForceProtectionToolbarItem = !realm.bruteForceProtected ? (\n    <ToolbarItem>\n      <Button\n        variant={ButtonVariant.link}\n        onClick={toggleDeleteDialog}\n        data-testid=\"delete-user-btn\"\n        isDisabled={hasSelectedRows}\n      >\n        {t(\"deleteUser\")}\n      </Button>\n    </ToolbarItem>\n  ) : (\n    <ToolbarItem>\n      <Dropdown\n        onOpenChange={(isOpen) => setKebabOpen(isOpen)}\n        toggle={(ref) => (\n          <MenuToggle\n            ref={ref}\n            isExpanded={kebabOpen}\n            variant=\"plain\"\n            onClick={() => setKebabOpen(!kebabOpen)}\n          >\n            <EllipsisVIcon />\n          </MenuToggle>\n        )}\n        isOpen={kebabOpen}\n        shouldFocusToggleOnSelect\n      >\n        <DropdownList>\n          <DropdownItem\n            key=\"deleteUser\"\n            component=\"button\"\n            isDisabled={hasSelectedRows}\n            onClick={() => {\n              toggleDeleteDialog();\n              setKebabOpen(false);\n            }}\n          >\n            {t(\"deleteUser\")}\n          </DropdownItem>\n\n          <DropdownItem\n            key=\"unlock\"\n            component=\"button\"\n            onClick={() => {\n              toggleUnlockUsersDialog();\n              setKebabOpen(false);\n            }}\n          >\n            {t(\"unlockAllUsers\")}\n          </DropdownItem>\n        </DropdownList>\n      </Dropdown>\n    </ToolbarItem>\n  );\n\n  const actionItems = (\n    <>\n      <ToolbarItem>\n        <Button data-testid=\"add-user\" onClick={goToCreate}>\n          {t(\"addUser\")}\n        </Button>\n      </ToolbarItem>\n      {bruteForceProtectionToolbarItem}\n    </>\n  );\n\n  return (\n    <>\n      {searchItem()}\n      {isManager ? actionItems : null}\n    </>\n  );\n}\n","import type ComponentRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/componentRepresentation\";\nimport type { UserProfileConfig } from \"@keycloak/keycloak-admin-client/lib/defs/userProfileMetadata\";\nimport type UserRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/userRepresentation\";\nimport {\n  AlertVariant,\n  Button,\n  ButtonVariant,\n  Chip,\n  ChipGroup,\n  EmptyState,\n  FlexItem,\n  Label,\n  Text,\n  TextContent,\n  Toolbar,\n  ToolbarContent,\n  ToolbarItem,\n  Tooltip,\n} from \"@patternfly/react-core\";\nimport {\n  ExclamationCircleIcon,\n  InfoCircleIcon,\n  WarningTriangleIcon,\n} from \"@patternfly/react-icons\";\nimport type { IRowData } from \"@patternfly/react-table\";\nimport { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport { useAdminClient } from \"../../admin-client\";\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\nimport { SearchType } from \"../../user/details/SearchFilter\";\nimport { toAddUser } from \"../../user/routes/AddUser\";\nimport { toUser } from \"../../user/routes/User\";\nimport { emptyFormatter } from \"../../util\";\nimport { useFetch } from \"../../utils/useFetch\";\nimport { useAlerts } from \"../alert/Alerts\";\nimport { useConfirmDialog } from \"../confirm-dialog/ConfirmDialog\";\nimport { KeycloakSpinner } from \"../keycloak-spinner/KeycloakSpinner\";\nimport { ListEmptyState } from \"../list-empty-state/ListEmptyState\";\nimport { BruteUser, findUsers } from \"../role-mapping/resource\";\nimport { KeycloakDataTable } from \"../table-toolbar/KeycloakDataTable\";\nimport { UserDataTableToolbarItems } from \"./UserDataTableToolbarItems\";\n\nexport type UserAttribute = {\n  name: string;\n  displayName: string;\n  value: string;\n};\n\nconst UserDetailLink = (user: BruteUser) => {\n  const { realm } = useRealm();\n  return (\n    <Link to={toUser({ realm, id: user.id!, tab: \"settings\" })}>\n      {user.username} <StatusRow user={user} />\n    </Link>\n  );\n};\n\ntype StatusRowProps = {\n  user: BruteUser;\n};\n\nconst StatusRow = ({ user }: StatusRowProps) => {\n  const { t } = useTranslation();\n  return (\n    <>\n      {!user.enabled && (\n        <Label color=\"red\" icon={<InfoCircleIcon />}>\n          {t(\"disabled\")}\n        </Label>\n      )}\n      {user.bruteForceStatus?.disabled && (\n        <Label color=\"orange\" icon={<WarningTriangleIcon />}>\n          {t(\"temporaryLocked\")}\n        </Label>\n      )}\n    </>\n  );\n};\n\nconst ValidatedEmail = (user: UserRepresentation) => {\n  const { t } = useTranslation();\n  return (\n    <>\n      {!user.emailVerified && (\n        <Tooltip content={t(\"notVerified\")}>\n          <ExclamationCircleIcon className=\"keycloak__user-section__email-verified\" />\n        </Tooltip>\n      )}{\" \"}\n      {emptyFormatter()(user.email)}\n    </>\n  );\n};\n\nexport function UserDataTable() {\n  const { adminClient } = useAdminClient();\n\n  const { t } = useTranslation();\n  const { addAlert, addError } = useAlerts();\n  const { realm: realmName, realmRepresentation: realm } = useRealm();\n  const navigate = useNavigate();\n  const [userStorage, setUserStorage] = useState<ComponentRepresentation[]>();\n  const [searchUser, setSearchUser] = useState(\"\");\n  const [selectedRows, setSelectedRows] = useState<UserRepresentation[]>([]);\n  const [searchType, setSearchType] = useState<SearchType>(\"default\");\n  const [searchDropdownOpen, setSearchDropdownOpen] = useState(false);\n  const [activeFilters, setActiveFilters] = useState<UserAttribute[]>([]);\n  const [profile, setProfile] = useState<UserProfileConfig>({});\n  const [query, setQuery] = useState(\"\");\n\n  const [key, setKey] = useState(0);\n  const refresh = () => setKey(key + 1);\n\n  useFetch(\n    async () => {\n      const testParams = {\n        type: \"org.keycloak.storage.UserStorageProvider\",\n      };\n\n      try {\n        return await Promise.all([\n          adminClient.components.find(testParams),\n          adminClient.users.getProfile(),\n        ]);\n      } catch {\n        return [[], {}] as [ComponentRepresentation[], UserProfileConfig];\n      }\n    },\n    ([storageProviders, profile]) => {\n      setUserStorage(\n        storageProviders.filter((p) => p.config?.enabled?.[0] === \"true\"),\n      );\n      setProfile(profile);\n    },\n    [],\n  );\n\n  const loader = async (first?: number, max?: number, search?: string) => {\n    const params: { [name: string]: string | number } = {\n      first: first!,\n      max: max!,\n      q: query!,\n    };\n\n    const searchParam = search || searchUser || \"\";\n    if (searchParam) {\n      params.search = searchParam;\n    }\n\n    if (!listUsers && !(params.search || params.q)) {\n      return [];\n    }\n\n    try {\n      return await findUsers(adminClient, {\n        briefRepresentation: true,\n        ...params,\n      });\n    } catch (error) {\n      if (userStorage?.length) {\n        addError(\"noUsersFoundErrorStorage\", error);\n      } else {\n        addError(\"noUsersFoundError\", error);\n      }\n      return [];\n    }\n  };\n\n  const [toggleUnlockUsersDialog, UnlockUsersConfirm] = useConfirmDialog({\n    titleKey: \"unlockAllUsers\",\n    messageKey: \"unlockUsersConfirm\",\n    continueButtonLabel: \"unlock\",\n    onConfirm: async () => {\n      try {\n        await adminClient.attackDetection.delAll();\n        refresh();\n        addAlert(t(\"unlockUsersSuccess\"), AlertVariant.success);\n      } catch (error) {\n        addError(\"unlockUsersError\", error);\n      }\n    },\n  });\n\n  const [toggleDeleteDialog, DeleteConfirm] = useConfirmDialog({\n    titleKey: \"deleteConfirmUsers\",\n    messageKey: t(\"deleteConfirmDialog\", { count: selectedRows.length }),\n    continueButtonLabel: \"delete\",\n    continueButtonVariant: ButtonVariant.danger,\n    onConfirm: async () => {\n      try {\n        for (const user of selectedRows) {\n          await adminClient.users.del({ id: user.id! });\n        }\n        setSelectedRows([]);\n        clearAllFilters();\n        addAlert(t(\"userDeletedSuccess\"), AlertVariant.success);\n      } catch (error) {\n        addError(\"userDeletedError\", error);\n      }\n    },\n  });\n\n  const goToCreate = () => navigate(toAddUser({ realm: realmName }));\n\n  if (!userStorage || !realm) {\n    return <KeycloakSpinner />;\n  }\n\n  //should *only* list users when no user federation is configured\n  const listUsers = !(userStorage.length > 0);\n\n  const clearAllFilters = () => {\n    const filtered = [...activeFilters].filter(\n      (chip) => chip.name !== chip.name,\n    );\n    setActiveFilters(filtered);\n    setSearchUser(\"\");\n    setQuery(\"\");\n    refresh();\n  };\n\n  const createQueryString = (filters: UserAttribute[]) => {\n    return filters.map((filter) => `${filter.name}:${filter.value}`).join(\" \");\n  };\n\n  const searchUserWithAttributes = () => {\n    const attributes = createQueryString(activeFilters);\n    setQuery(attributes);\n    refresh();\n  };\n\n  const createAttributeSearchChips = () => {\n    return (\n      <FlexItem>\n        {activeFilters.length > 0 && (\n          <>\n            {Object.values(activeFilters).map((entry) => {\n              return (\n                <ChipGroup\n                  className=\"pf-v5-u-mt-md pf-v5-u-mr-md\"\n                  key={entry.name}\n                  categoryName={\n                    entry.displayName.length ? entry.displayName : entry.name\n                  }\n                  isClosable\n                  onClick={(event) => {\n                    event.stopPropagation();\n\n                    const filtered = [...activeFilters].filter(\n                      (chip) => chip.name !== entry.name,\n                    );\n                    const attributes = createQueryString(filtered);\n\n                    setActiveFilters(filtered);\n                    setQuery(attributes);\n                    refresh();\n                  }}\n                >\n                  <Chip key={entry.name} isReadOnly>\n                    {entry.value}\n                  </Chip>\n                </ChipGroup>\n              );\n            })}\n          </>\n        )}\n      </FlexItem>\n    );\n  };\n\n  const toolbar = () => {\n    return (\n      <UserDataTableToolbarItems\n        searchDropdownOpen={searchDropdownOpen}\n        setSearchDropdownOpen={setSearchDropdownOpen}\n        realm={realm}\n        hasSelectedRows={selectedRows.length === 0}\n        toggleDeleteDialog={toggleDeleteDialog}\n        toggleUnlockUsersDialog={toggleUnlockUsersDialog}\n        goToCreate={goToCreate}\n        searchType={searchType}\n        setSearchType={setSearchType}\n        searchUser={searchUser}\n        setSearchUser={setSearchUser}\n        activeFilters={activeFilters}\n        setActiveFilters={setActiveFilters}\n        refresh={refresh}\n        profile={profile}\n        clearAllFilters={clearAllFilters}\n        createAttributeSearchChips={createAttributeSearchChips}\n        searchUserWithAttributes={searchUserWithAttributes}\n      />\n    );\n  };\n\n  const subtoolbar = () => {\n    if (!activeFilters.length) {\n      return;\n    }\n    return (\n      <div className=\"user-attribute-search-form-subtoolbar\">\n        <ToolbarItem>{createAttributeSearchChips()}</ToolbarItem>\n        <ToolbarItem>\n          <Button\n            variant=\"link\"\n            onClick={() => {\n              clearAllFilters();\n            }}\n          >\n            {t(\"clearAllFilters\")}\n          </Button>\n        </ToolbarItem>\n      </div>\n    );\n  };\n\n  return (\n    <>\n      <DeleteConfirm />\n      <UnlockUsersConfirm />\n      <KeycloakDataTable\n        isSearching={searchUser !== \"\" || activeFilters.length !== 0}\n        key={key}\n        loader={loader}\n        isPaginated\n        ariaLabelKey=\"titleUsers\"\n        canSelectAll\n        onSelect={(rows: UserRepresentation[]) => setSelectedRows([...rows])}\n        emptyState={\n          !listUsers ? (\n            <>\n              <Toolbar>\n                <ToolbarContent>{toolbar()}</ToolbarContent>\n              </Toolbar>\n              <EmptyState data-testid=\"empty-state\" variant=\"lg\">\n                <TextContent className=\"kc-search-users-text\">\n                  <Text>{t(\"searchForUserDescription\")}</Text>\n                </TextContent>\n              </EmptyState>\n            </>\n          ) : (\n            <ListEmptyState\n              message={t(\"noUsersFound\")}\n              instructions={t(\"emptyInstructions\")}\n              primaryActionText={t(\"createNewUser\")}\n              onPrimaryAction={goToCreate}\n            />\n          )\n        }\n        toolbarItem={toolbar()}\n        subToolbar={subtoolbar()}\n        actionResolver={(rowData: IRowData) => {\n          const user: UserRepresentation = rowData.data;\n          if (!user.access?.manage) return [];\n\n          return [\n            {\n              title: t(\"delete\"),\n              onClick: () => {\n                setSelectedRows([user]);\n                toggleDeleteDialog();\n              },\n            },\n          ];\n        }}\n        columns={[\n          {\n            name: \"username\",\n            displayKey: \"username\",\n            cellRenderer: UserDetailLink,\n          },\n          {\n            name: \"email\",\n            displayKey: \"email\",\n            cellRenderer: ValidatedEmail,\n          },\n          {\n            name: \"lastName\",\n            displayKey: \"lastName\",\n            cellFormatters: [emptyFormatter()],\n          },\n          {\n            name: \"firstName\",\n            displayKey: \"firstName\",\n            cellFormatters: [emptyFormatter()],\n          },\n        ]}\n      />\n    </>\n  );\n}\n","import { useTranslation } from \"react-i18next\";\nimport { PageSection, Tab, TabTitleText } from \"@patternfly/react-core\";\n\nimport { ViewHeader } from \"../components/view-header/ViewHeader\";\nimport { useRealm } from \"../context/realm-context/RealmContext\";\nimport helpUrls from \"../help-urls\";\nimport { PermissionsTab } from \"../components/permission-tab/PermissionTab\";\nimport { UserDataTable } from \"../components/users/UserDataTable\";\nimport { toUsers, UserTab } from \"./routes/Users\";\nimport {\n  RoutableTabs,\n  useRoutableTab,\n} from \"../components/routable-tabs/RoutableTabs\";\nimport useIsFeatureEnabled, { Feature } from \"../utils/useIsFeatureEnabled\";\nimport \"./user-section.css\";\nimport { useAccess } from \"../context/access/Access\";\n\nexport default function UsersSection() {\n  const { t } = useTranslation();\n  const { realm: realmName } = useRealm();\n  const { hasAccess } = useAccess();\n  const isFeatureEnabled = useIsFeatureEnabled();\n\n  const canViewPermissions =\n    isFeatureEnabled(Feature.AdminFineGrainedAuthz) &&\n    hasAccess(\"manage-authorization\", \"manage-users\", \"manage-clients\");\n\n  const useTab = (tab: UserTab) =>\n    useRoutableTab(\n      toUsers({\n        realm: realmName,\n        tab,\n      }),\n    );\n\n  const listTab = useTab(\"list\");\n  const permissionsTab = useTab(\"permissions\");\n\n  return (\n    <>\n      <ViewHeader\n        titleKey=\"titleUsers\"\n        subKey=\"usersExplain\"\n        helpUrl={helpUrls.usersUrl}\n        divider={false}\n      />\n      <PageSection\n        data-testid=\"users-page\"\n        variant=\"light\"\n        className=\"pf-v5-u-p-0\"\n      >\n        <RoutableTabs\n          data-testid=\"user-tabs\"\n          defaultLocation={toUsers({\n            realm: realmName,\n            tab: \"list\",\n          })}\n          isBox\n          mountOnEnter\n        >\n          <Tab\n            id=\"list\"\n            data-testid=\"listTab\"\n            title={<TabTitleText>{t(\"userList\")}</TabTitleText>}\n            {...listTab}\n          >\n            <UserDataTable />\n          </Tab>\n          {canViewPermissions && (\n            <Tab\n              id=\"permissions\"\n              data-testid=\"permissionsTab\"\n              title={<TabTitleText>{t(\"permissions\")}</TabTitleText>}\n              {...permissionsTab}\n            >\n              <PermissionsTab type=\"users\" />\n            </Tab>\n          )}\n        </RoutableTabs>\n      </PageSection>\n    </>\n  );\n}\n"],"names":["SearchDropdown","searchType","onSelect","t","useTranslation","searchToggle","setSearchToggle","useState","createDropdown","jsx","DropdownItem","options","Dropdown","isOpen","ref","MenuToggle","FilterIcon","DropdownList","UserDataTableAttributeSearchForm","activeFilters","setActiveFilters","profile","createAttributeSearchChips","searchUserWithAttributes","addAlert","useAlerts","selectAttributeKeyOpen","setSelectAttributeKeyOpen","defaultValues","getValues","register","reset","errors","setValue","setError","clearErrors","useForm","isAttributeKeyDuplicate","filter","isAttributeNameValid","valid","isAttributeValueValid","isAttributeValid","addToFilter","AlertVariant","clearActiveFilters","filtered","chip","createAttributeKeyInputField","KeycloakSelect","SelectVariant","selectedValue","option","SelectOption","label","e","TextInput","jsxs","Form","TextContent","Text","TextVariants","Alert","InputGroup","InputGroupItem","Button","CheckIcon","ActionGroup","ButtonVariant","UserDataTableToolbarItems","searchDropdownOpen","setSearchDropdownOpen","realm","hasSelectedRows","toggleDeleteDialog","toggleUnlockUsersDialog","goToCreate","setSearchType","searchUser","setSearchUser","refresh","clearAllFilters","kebabOpen","setKebabOpen","hasAccess","useAccess","isManager","searchItem","ToolbarItem","defaultSearchInput","attributeSearchInput","SearchInput","_","_v","attribute","target","Fragment","DropdownPanel","ArrowRightIcon","bruteForceProtectionToolbarItem","EllipsisVIcon","actionItems","UserDetailLink","user","useRealm","Link","toUser","StatusRow","Label","InfoCircleIcon","WarningTriangleIcon","ValidatedEmail","Tooltip","ExclamationCircleIcon","emptyFormatter","UserDataTable","adminClient","useAdminClient","addError","realmName","navigate","useNavigate","userStorage","setUserStorage","selectedRows","setSelectedRows","setProfile","query","setQuery","key","setKey","useFetch","testParams","storageProviders","p","loader","first","max","search","params","searchParam","listUsers","findUsers","error","UnlockUsersConfirm","useConfirmDialog","DeleteConfirm","toAddUser","KeycloakSpinner","createQueryString","filters","attributes","FlexItem","entry","ChipGroup","event","Chip","toolbar","subtoolbar","KeycloakDataTable","rows","ListEmptyState","Toolbar","ToolbarContent","EmptyState","rowData","UsersSection","canViewPermissions","useIsFeatureEnabled","Feature","useTab","tab","useRoutableTab","toUsers","listTab","permissionsTab","ViewHeader","helpUrls","PageSection","RoutableTabs","Tab","TabTitleText","PermissionsTab"],"mappings":"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"}