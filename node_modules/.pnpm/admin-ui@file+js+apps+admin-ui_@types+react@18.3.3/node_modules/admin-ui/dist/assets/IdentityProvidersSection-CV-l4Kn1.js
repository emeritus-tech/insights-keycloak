import{jsx as e,jsxs as p,Fragment as k}from"react/jsx-runtime";import{cj as W,cA as J,cB as X,u as j,a as x,f as M,w as V,a3 as Z,M as q,r as Q,j as L,B as E,aa as w,Z as K,b as Y,c as G,d as _,l as ee,au as ae,P as re,$ as N,bs as te,ak as ie,al as T,cC as ne,a2 as F,J as se,K as oe,N as le,bK as de,L as ce,cx as me,bG as pe,cD as B,cE as ge,D as ue}from"./main-DXDh8SEc.js";import{useState as h,Fragment as he}from"react";import{u as fe}from"./ConfirmDialog-o8TAA2Kj.js";import{G as ve,C as De}from"./ClickableCard-Chrw7i-0.js";import{K as ye}from"./KeycloakDataTable-B3eTS_qk.js";import{V as be}from"./ViewHeader-DTd0a4sz.js";import{b as Ce,s as P}from"./sortBy-CKW5ov0F.js";import{c as Pe,d as Ie,a as Oe,b as ke,D as Le}from"./Droppable-GJMiYrK1.js";import{d as we,D as Ke,a as xe,b as Ae,c as Se}from"./DataListItemRow-CavOLjhh.js";import"react-dom";import"./PaginatingTableToolbar-zbU1l_6-.js";import"./EmptyStateFooter-C_ktbNPy.js";import"./EmptyStateActions-CiPKPOdJ.js";import"./Td-BmSS9qQq.js";import"./grip-vertical-icon-CgFEKIXW.js";import"./_baseFlatten-CMLUuI8z.js";function Ne(r,n,a,o){for(var l=-1,m=r==null?0:r.length;++l<m;){var d=r[l];n(o,d,a(d),r)}return o}function Te(r,n,a,o){return Ce(r,function(l,m,d){n(o,l,a(l),d)}),o}function Fe(r,n){return function(a,o){var l=J(a)?Ne:Te,m={};return l(a,r,W(o),m)}}var Be=Object.prototype,je=Be.hasOwnProperty,Me=Fe(function(r,n,a){je.call(r,a)?r[a].push(n):X(r,a,[n])});const Ve=({onClose:r})=>{const{adminClient:n}=j(),{t:a}=x(),{addAlert:o,addError:l}=M(),[m,d]=h(""),[D,y]=h(),[g,b]=h([]),C=({index:i})=>(d(a("onDragStart",{item:g[i]})),!0),f=({index:i})=>{d(a("onDragMove",{item:g[i]}))},I=(i,c)=>{if(c){const u=[...g],[v]=u.splice(i.index,1);return u.splice(c.index,0,v),d(a("onDragFinish",{list:u})),b(u),!0}else return d(a("onDragCancel")),!1};return V(()=>n.identityProviders.find(),i=>{y(i),b(P(i,["config.guiOrder","alias"]).map(c=>c.alias))},[]),D?p(q,{variant:Q.small,title:a("manageDisplayOrder"),isOpen:!0,onClose:r,actions:[e(L,{id:"modal-confirm","data-testid":"confirm",onClick:async()=>{const i=g.map((c,u)=>{const v=D.find(O=>O.alias===c);return v.config.guiOrder=u,n.identityProviders.update({alias:c},v)});try{await Promise.all(i),o(a("orderChangeSuccess"))}catch(c){l("orderChangeError",c)}r()},children:a("save")},"confirm"),e(L,{id:"modal-cancel","data-testid":"cancel",variant:E.link,onClick:r,children:a("cancel")},"cancel")],children:[e(w,{className:"pf-v5-u-pb-lg",children:e(K,{children:a("orderDialogIntro")})}),e(Pe,{onDrag:C,onDragMove:f,onDrop:I,children:e(Ie,{hasNoWrapper:!0,children:e(we,{"aria-label":a("manageOrderTableAria"),"data-testid":"manageOrderDataList",isCompact:!0,children:g.map(i=>e(Oe,{hasNoWrapper:!0,children:e(Ke,{"aria-label":i,id:i,children:p(xe,{children:[e(ke,{children:e(Le,{"aria-label":a("dragHelp")})}),e(Ae,{dataListCells:[e(Se,{"data-testid":i,children:i},i)]})]})})},i))})})}),e("div",{className:"pf-v5-screen-reader","aria-live":"assertive",children:m})]}):e(Z,{})},Ee=r=>{const{t:n}=x(),{realm:a}=G();return p(ce,{to:me({realm:a,providerId:r.providerId,alias:r.alias,tab:"settings"}),children:[r.displayName||r.alias,!r.enabled&&e(pe,{isRead:!0,className:"pf-v5-u-ml-sm",children:n("disabled")},`${r.providerId}-disabled`)]},r.providerId)};function ta(){const{adminClient:r}=j(),{t:n}=x(),a=Me(Y().identityProviders,"groupName"),{realm:o}=G(),l=_(),[m,d]=h(0),D=()=>d(m+1),[y,g]=h(!1),[b,C]=h(!1),[f,I]=h(!1),[i,c]=h(),{addAlert:u,addError:v}=M();V(async()=>r.identityProviders.find({max:1}),t=>{I(t.length===1)},[m]);const O=async(t,s,A)=>{const S={first:t,max:s};A&&(S.search=A);const z=await r.identityProviders.find(S);return P(z,"alias")},R=t=>l(B({realm:o,providerId:t})),$=()=>Object.keys(a).map(t=>e(ge,{label:t,children:P(a[t],"name").map(s=>e(ue,{value:s.id,component:"a","data-testid":s.id,onClick:()=>l(B({realm:o,providerId:s.id})),children:s.name},s.id))},t)),[H,U]=fe({titleKey:"deleteProvider",messageKey:n("deleteConfirm",{provider:i?.alias}),continueButtonLabel:"delete",continueButtonVariant:E.danger,onConfirm:async()=>{try{await r.identityProviders.del({alias:i.alias}),D(),u(n("deletedSuccessIdentityProvider"),ee.success)}catch(t){v("deleteErrorIdentityProvider",t)}}});return p(k,{children:[e(U,{}),b&&e(Ve,{onClose:()=>{C(!1),D()}}),e(be,{titleKey:"identityProviders",subKey:"listExplain",helpUrl:ae.identityProvidersUrl}),p(re,{variant:f?"light":"default",className:f?"pf-v5-u-p-0":"",children:[!f&&p(k,{children:[e(w,{children:e(K,{component:N.p,children:n("getStarted")})}),Object.keys(a).map(t=>p(he,{children:[e(w,{children:p(K,{className:"pf-v5-u-mt-lg",component:N.h2,children:[t,":"]})}),e("hr",{className:"pf-v5-u-mb-lg"}),e(ve,{hasGutter:!0,children:P(a[t],"name").map(s=>e(De,{"data-testid":`${s.id}-card`,onClick:()=>R(s.id),children:e(te,{children:p(ie,{hasGutter:!0,children:[e(T,{children:e(ne,{icon:s.id})}),e(T,{isFilled:!0,children:s.name})]})})},s.id))})]},t))]}),f&&e(ye,{loader:O,isPaginated:!0,ariaLabelKey:"identityProviders",searchPlaceholderKey:"searchForProvider",toolbarItem:p(k,{children:[e(F,{children:e(se,{"data-testid":"addProviderDropdown",onOpenChange:t=>g(t),toggle:t=>e(oe,{ref:t,onClick:()=>g(!y),variant:"primary",children:n("addProvider")}),isOpen:y,children:e(le,{children:$()})})}),e(F,{children:e(L,{"data-testid":"manageDisplayOrder",variant:"link",onClick:()=>C(!0),children:n("manageDisplayOrder")})})]}),actions:[{title:n("delete"),onRowClick:t=>{c(t),H()}}],columns:[{name:"alias",displayKey:"name",cellRenderer:Ee},{name:"providerId",displayKey:"providerDetails",cellFormatters:[de()]},{name:"config['kc.org']",displayKey:"linkedOrganization",cellFormatters:[t=>t?"X":"â€”"]}]},m)]})]})}export{ta as default};
//# sourceMappingURL=IdentityProvidersSection-CV-l4Kn1.js.map
