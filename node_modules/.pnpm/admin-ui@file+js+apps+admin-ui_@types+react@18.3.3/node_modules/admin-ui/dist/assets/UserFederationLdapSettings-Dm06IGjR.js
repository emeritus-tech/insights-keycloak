import{jsxs as M,Fragment as R,jsx as e}from"react/jsx-runtime";import{useState as m}from"react";import{u as A,d as I,a as k,f as K,v as U,e as x,w as E,B as V,l as w,a2 as j,j as N,L as B,x as z,g as H,c as O,a3 as q,F as G,P as F,ek as T,el as C}from"./main-DXDh8SEc.js";import{R as J,u as Q}from"./RoutableTabs-CmXecBCx.js";import{U as W,s as X}from"./UserFederationLdapForm-CkmvEqFZ.js";import{u as Y}from"./ConfirmDialog-o8TAA2Kj.js";import{L as Z}from"./PaginatingTableToolbar-zbU1l_6-.js";import{K as _}from"./KeycloakDataTable-B3eTS_qk.js";import{E as $}from"./ExtendedHeader-DISZMVW_.js";import{a as P,b as D}from"./Tabs-DuqZmBlh.js";import"react-dom";import"./PageHandler-BSpHpuNc.js";import"./DynamicComponents-oH6U-qv7.js";import"./ClientSelect-DzH7E0lJ.js";import"./FileUpload-CK_LBb0x.js";import"./CodeEditor-BFrRAdAy.js";import"./copy-icon-C4kUIpk5.js";import"./EmptyStateFooter-C_ktbNPy.js";import"./EmptyStateActions-CiPKPOdJ.js";import"./GroupPickerDialog-B6DOUphD.js";import"./DataListItemRow-CavOLjhh.js";import"./FlexItem-c5qvFYFZ.js";import"./KeySelect-BIWWws15.js";import"./useToggle-K3Kx99tM.js";import"./MultiLineInput-D3_8dp6S.js";import"./AddRoleMappingModal-BqIKRo9T.js";import"./filter-icon-Do5tIUfA.js";import"./Td-BmSS9qQq.js";import"./grip-vertical-icon-CgFEKIXW.js";import"./ViewHeader-DTd0a4sz.js";import"./useParams-5577fL9S.js";import"./PageList-BqPOEpg8.js";import"./_baseFlatten-CMLUuI8z.js";import"./FormAccess-Bcw0IOUQ.js";import"./SettingsCache-DQ1ndLIK.js";import"./isEqual-DfpijAgC.js";const ee=({toDetail:i,...o})=>e(B,{to:i(o.id),children:o.name}),te=({toCreate:i,toDetail:o})=>{const{adminClient:s}=A(),n=I(),{t:r}=k(),{addAlert:g,addError:f}=K(),[p,y]=m(0),h=()=>y(p+1),[b,S]=m([]),d=U(),{id:L}=x(),[c,l]=m();E(()=>s.components.find({parent:L,type:"org.keycloak.storage.ldap.mappers.LDAPStorageMapper"}),a=>{S(d(a.map(v=>({...v,name:v.name,type:v.providerId})),z("name")))},[p]);const[u,t]=Y({titleKey:r("deleteMappingTitle",{mapperId:c?.id}),messageKey:"deleteMappingConfirm",continueButtonLabel:"delete",continueButtonVariant:V.danger,onConfirm:async()=>{try{await s.components.del({id:c.id}),h(),g(r("mappingDeletedSuccess"),w.success),l(void 0)}catch(a){f("mappingDeletedError",a)}}});return M(R,{children:[e(t,{}),e(_,{loader:b,ariaLabelKey:"ldapMappersList",searchPlaceholderKey:"searchForMapper",toolbarItem:e(j,{children:e(N,{"data-testid":"add-mapper-btn",variant:"primary",component:a=>e(B,{...a,to:i}),children:r("addMapper")})}),actions:[{title:r("delete"),onRowClick:a=>{l(a),u()}}],columns:[{name:"name",cellRenderer:a=>e(ee,{...a,toDetail:o})},{name:"type"}],emptyState:e(Z,{message:r("emptyMappers"),instructions:r("emptyMappersInstructions"),primaryActionText:r("emptyPrimaryAction"),onPrimaryAction:()=>n(i)})},p)]})};function Ve(){const{adminClient:i}=A(),{t:o}=k(),s=H({mode:"onChange"}),{realm:n}=O(),{id:r}=x(),{addAlert:g,addError:f}=K(),[p,y]=m(),[h,b]=m(0),S=()=>b(t=>t+1);E(()=>i.components.findOne({id:r}),t=>{if(!t)throw new Error(o("notFound"));y(t),l(t)},[r,h]);const d=t=>Q(T({realm:n,id:r,tab:t})),L=d("settings"),c=d("mappers"),l=t=>{s.reset(t),s.setValue("config.periodicChangedUsersSync",t.config?.changedSyncPeriod?.[0]!=="-1"),s.setValue("config.periodicFullSync",t.config?.fullSyncPeriod?.[0]!=="-1")},u=async t=>{try{await i.components.update({id:r},X(t)),g(o("userProviderSaveSuccess"),w.success),S()}catch(a){f("userProviderSaveError",a)}};return p?M(G,{...s,children:[e($,{provider:"LDAP",noDivider:!0,editMode:p.config?.editMode,save:()=>s.handleSubmit(u)()}),e(F,{variant:"light",className:"pf-v5-u-p-0",children:M(J,{defaultLocation:T({realm:n,id:r,tab:"settings"}),isBox:!0,children:[e(P,{id:"settings",title:e(D,{children:o("settings")}),...L,children:e(F,{variant:"light",children:e(W,{id:r,onSubmit:u})})}),e(P,{id:"mappers",title:e(D,{children:o("mappers")}),"data-testid":"ldap-mappers-tab",...c,children:e(te,{toCreate:C({realm:n,id:r,mapperId:"new"}),toDetail:t=>C({realm:n,id:r,mapperId:t})})})]})})]}):e(q,{})}export{Ve as default};
//# sourceMappingURL=UserFederationLdapSettings-Dm06IGjR.js.map
