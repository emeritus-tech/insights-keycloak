import{jsxs as h,jsx as e,Fragment as T}from"react/jsx-runtime";import{useState as C}from"react";import{u as v,a as R,f as D,b3 as I,P as E,ac as x,ad as P,a4 as F,ar as L,l as b,d as O,w as k,a3 as H,aF as g,bR as w}from"./main-DXDh8SEc.js";import{M as K}from"./MapperList-D-E46ujn.js";import{R as N,u as V}from"./RoutableTabs-CmXecBCx.js";import{V as j}from"./ViewHeader-DTd0a4sz.js";import{u as G}from"./useParams-5577fL9S.js";import{F as z}from"./FormAccess-Bcw0IOUQ.js";import{R as B}from"./AddRoleMappingModal-BqIKRo9T.js";import{a as y,b as M}from"./Tabs-DuqZmBlh.js";import"react-dom";import"./PaginatingTableToolbar-zbU1l_6-.js";import"./EmptyStateFooter-C_ktbNPy.js";import"./EmptyStateActions-CiPKPOdJ.js";import"./KeycloakDataTable-B3eTS_qk.js";import"./Td-BmSS9qQq.js";import"./grip-vertical-icon-CgFEKIXW.js";import"./_baseFlatten-CMLUuI8z.js";import"./DataListItemRow-CavOLjhh.js";import"./PageHandler-BSpHpuNc.js";import"./DynamicComponents-oH6U-qv7.js";import"./ClientSelect-DzH7E0lJ.js";import"./FileUpload-CK_LBb0x.js";import"./CodeEditor-BFrRAdAy.js";import"./copy-icon-C4kUIpk5.js";import"./GroupPickerDialog-B6DOUphD.js";import"./FlexItem-c5qvFYFZ.js";import"./KeySelect-BIWWws15.js";import"./useToggle-K3Kx99tM.js";import"./MultiLineInput-D3_8dp6S.js";import"./PageList-BqPOEpg8.js";import"./ConfirmDialog-o8TAA2Kj.js";import"./filter-icon-Do5tIUfA.js";const J=({client:p})=>{const{adminClient:s}=v(),{t:r}=R(),{addAlert:l,addError:m}=D(),[t,f]=C(p),{hasAccess:i}=I(),u=i("manage-clients")||t.access?.manage,S=async c=>{try{const n=c.filter(a=>a.client===void 0).map(a=>a.role).flat();await Promise.all([s.clients.addRealmScopeMappings({id:t.id},n),...c.filter(a=>a.client!==void 0).map(a=>s.clients.addClientScopeMappings({id:t.id,client:a.client.id},[a.role]))]),l(r("clientScopeSuccess"),b.success)}catch(n){m("clientScopeError",n)}},A=async()=>{const c={...t,fullScopeAllowed:!t.fullScopeAllowed};try{await s.clients.update({id:t.id},c),l(r("clientScopeSuccess"),b.success),f(c)}catch(n){m("clientScopeError",n)}};return h(E,{children:[e(z,{role:"manage-clients",fineGrainedAccess:t.access?.manage,isHorizontal:!0,children:e(x,{hasNoPaddingTop:!0,label:r("fullScopeAllowed"),labelIcon:e(P,{helpText:r("fullScopeAllowedHelp"),fieldLabelId:"fullScopeAllowed"}),fieldId:"fullScopeAllowed",children:e(F,{id:"fullScopeAllowed",label:r("on"),labelOff:r("off"),isChecked:t.fullScopeAllowed,onChange:A,"aria-label":r("fullScopeAllowed")})})}),!t.fullScopeAllowed&&h(T,{children:[e(L,{}),e(B,{name:t.clientId,id:t.id,type:"clients",save:S,isManager:u})]})]})};function Ce(){const{adminClient:p}=v(),{t:s}=R(),r=O(),{realm:l,clientId:m}=G(),{addAlert:t,addError:f}=D(),[i,u]=C();k(()=>p.clients.findOne({id:m}),u,[]);const S=o=>V(g({realm:l,clientId:m,tab:o})),A=S("mappers"),c=S("scope");if(!i)return e(H,{});const n=async o=>{if(Array.isArray(o))try{await p.clients.addMultipleProtocolMappers({id:i.id},o),u(await p.clients.findOne({id:i.id})),t(s("mappingCreatedSuccess"),b.success)}catch(d){f("mappingCreatedError",d)}else{const d=o;r(w({realm:l,id:i.id,mapperId:d.id}))}},a=async o=>{try{await p.clients.delProtocolMapper({id:i.id,mapperId:o.id}),u({...i,protocolMappers:i.protocolMappers?.filter(d=>d.id!==o.id)}),t(s("mappingDeletedSuccess"),b.success)}catch(d){f("mappingDeletedError",d)}return!0};return h(T,{children:[e(j,{titleKey:i.clientId+"-dedicated",subKey:"dedicatedScopeExplain",divider:!1}),e(E,{variant:"light",className:"pf-v5-u-p-0",children:h(N,{isBox:!0,mountOnEnter:!0,defaultLocation:g({realm:l,clientId:m,tab:"mappers"}),children:[e(y,{title:e(M,{children:s("mappers")}),"data-testid":"mappersTab",...A,children:e(K,{model:i,onAdd:n,onDelete:a,detailLink:o=>w({realm:l,id:i.id,mapperId:o})})}),e(y,{title:e(M,{children:s("scope")}),"data-testid":"scopeTab",...c,children:e(J,{client:i})})]})})]})}export{Ce as default};
//# sourceMappingURL=DedicatedScopes-XfXw51cZ.js.map
