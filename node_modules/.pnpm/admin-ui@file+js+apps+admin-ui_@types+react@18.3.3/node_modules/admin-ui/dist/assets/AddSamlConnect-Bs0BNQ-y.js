import{jsxs as l,Fragment as y,jsx as e}from"react/jsx-runtime";import{u as h,bH as F,a as S,c as b,aj as I,T as P,y as C,ac as w,ad as A,aq as x,a6 as D,a8 as T,a7 as k,d as j,g as H,f as V,P as U,F as $,A as z,j as g,L,cw as q,l as B,cx as G}from"./main-DXDh8SEc.js";import{F as O}from"./FormAccess-Bcw0IOUQ.js";import{V as N}from"./ViewHeader-DTd0a4sz.js";import{F as W}from"./FileUploadForm-DD1wLZX_.js";import{D as _}from"./DiscoveryEndpointField-Cr9LtOsT.js";import{D as J,S as K}from"./SamlGeneralSettings-DBhckO83.js";import"react";import"react-dom";import"./copy-icon-C4kUIpk5.js";import"./FileUpload-CK_LBb0x.js";import"./CodeEditor-BFrRAdAy.js";import"./EmptyStateFooter-C_ktbNPy.js";import"./EmptyStateActions-CiPKPOdJ.js";import"./SwitchControl-BOCtuOhh.js";/* empty css                           */import"./ExpandableSection-DTt8Mv0C.js";import"./DisplayOrder-BglivDc3.js";const R=()=>{const{adminClient:c}=h(),{environment:o}=F(),{t}=S(),s="saml",{realm:n}=b(),{setValue:u,setError:m,clearErrors:f,formState:{errors:d}}=I(),p=r=>{Object.entries(r).map(([a,i])=>u(`config.${a}`,i))},v=async r=>{if(f("discoveryError"),!r)return;const a=new FormData;a.append("providerId",s),a.append("file",new Blob([r]));try{const i=await D(`${T(c.baseUrl)}admin/realms/${n}/identity-provider/import-config`,{method:"POST",body:a,headers:k(await c.getAccessToken())});if(i.ok){const E=await i.json();p(E)}else m("discoveryError",{type:"manual",message:i.statusText})}catch(i){m("discoveryError",{type:"manual",message:i.message})}};return l(y,{children:[e(P,{headingLevel:"h2",size:"xl",className:"kc-form-panel__title",children:t("samlSettings")}),e(C,{name:"config.entityId",label:t("serviceProviderEntityId"),labelIcon:t("serviceProviderEntityIdHelp"),defaultValue:`${o.serverBaseUrl}/realms/${n}`,rules:{required:t("required")}}),e(_,{id:"saml",fileUpload:l(w,{label:t("importConfig"),fieldId:"kc-import-config",labelIcon:e(A,{helpText:t("importConfigHelp"),fieldLabelId:"importConfig"}),children:[e(W,{id:"kc-import-config",extension:".xml",hideDefaultPreview:!0,unWrap:!0,validated:d.discoveryError?"error":"default",onChange:r=>v(r)}),d.discoveryError&&e(x,{message:d.discoveryError.message})]}),children:r=>e(J,{readOnly:r})})]})};function ue(){const{adminClient:c}=h(),{t:o}=S(),t=j(),s="saml",n=H({defaultValues:{alias:s,config:{allowCreate:"true"}},mode:"onChange"}),{handleSubmit:u,formState:{isDirty:m}}=n,{addAlert:f,addError:d}=V(),{realm:p}=b(),v=async r=>{delete r.discoveryEndpoint;try{await c.identityProviders.create({...r,providerId:s}),f(o("createIdentityProviderSuccess"),B.success),t(G({realm:p,providerId:s,alias:r.alias,tab:"settings"}))}catch(a){d("createIdentityProviderError",a)}};return l(y,{children:[e(N,{titleKey:o("addSamlProvider")}),e(U,{variant:"light",children:e($,{...n,children:l(O,{role:"manage-identity-providers",isHorizontal:!0,onSubmit:u(v),children:[e(K,{}),e(R,{}),l(z,{children:[e(g,{isDisabled:!m,variant:"primary",type:"submit","data-testid":"createProvider",children:o("add")}),e(g,{variant:"link","data-testid":"cancel",component:r=>e(L,{...r,to:q({realm:p})}),children:o("cancel")})]})]})})})]})}export{ue as default};
//# sourceMappingURL=AddSamlConnect-Bs0BNQ-y.js.map
