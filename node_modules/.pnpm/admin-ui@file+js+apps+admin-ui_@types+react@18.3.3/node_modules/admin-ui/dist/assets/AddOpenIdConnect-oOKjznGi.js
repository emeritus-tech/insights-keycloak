import{jsxs as d,Fragment as v,jsx as e}from"react/jsx-runtime";import{u as g,a as h,aj as C,T as P,ac as S,ad as b,aq as k,d as D,bL as E,g as O,f as A,c as x,P as w,F as L,A as j,j as f,L as T,cw as U,l as V,cx as J}from"./main-DXDh8SEc.js";import{F as z}from"./FormAccess-Bcw0IOUQ.js";import{V as G}from"./ViewHeader-DTd0a4sz.js";import{D as H,O as K,a as N}from"./OIDCGeneralSettings-Cb7BtrEa.js";import{J as B}from"./JsonFileUpload-CBV06Hml.js";import{D as _}from"./DiscoveryEndpointField-Cr9LtOsT.js";import"react";import"react-dom";import"./copy-icon-C4kUIpk5.js";import"./SwitchControl-BOCtuOhh.js";/* empty css                           */import"./ExpandableSection-DTt8Mv0C.js";import"./ClientIdSecret-CkL_Gb68.js";import"./DisplayOrder-BglivDc3.js";import"./FileUploadForm-DD1wLZX_.js";import"./FileUpload-CK_LBb0x.js";import"./CodeEditor-BFrRAdAy.js";import"./EmptyStateFooter-C_ktbNPy.js";import"./EmptyStateActions-CiPKPOdJ.js";const $=()=>{const{adminClient:l}=g(),{t}=h(),m="oidc",{setValue:p,setError:c,clearErrors:s,formState:{errors:o}}=C(),u=r=>{Object.keys(r).map(i=>p(`config.${i}`,r[i]))},y=async r=>{if(s("discoveryError"),!r)return;const i=new FormData;i.append("providerId",m),i.append("file",new Blob([JSON.stringify(r)]));try{const a=await l.identityProviders.importFromUrl(i);u(a)}catch(a){c("discoveryError",{type:"manual",message:a.message})}};return d(v,{children:[e(P,{headingLevel:"h2",size:"xl",className:"kc-form-panel__title",children:t("oidcSettings")}),e(_,{id:"oidc",fileUpload:d(S,{label:t("importConfig"),fieldId:"kc-import-config",labelIcon:e(b,{helpText:t("importConfigHelp"),fieldLabelId:"importConfig"}),children:[e(B,{id:"kc-import-config",helpText:t("identity=providers-help:jsonFileUpload"),hideDefaultPreview:!0,unWrap:!0,validated:o.discoveryError?"error":"default",onChange:r=>y(r)}),o.discoveryError&&e(k,{message:o.discoveryError.message})]}),children:r=>e(H,{readOnly:r})})]})};function pe(){const{adminClient:l}=g(),{t}=h(),m=D(),{pathname:p}=E(),c=p.includes("keycloak-oidc"),s=`${c?"keycloak-":""}oidc`,o=O({defaultValues:{alias:s},mode:"onChange"}),{handleSubmit:u,formState:{isDirty:y}}=o,{addAlert:r,addError:i}=A(),{realm:a}=x(),I=async n=>{delete n.discoveryEndpoint;try{await l.identityProviders.create({...n,providerId:s}),r(t("createIdentityProviderSuccess"),V.success),m(J({realm:a,providerId:s,alias:n.alias,tab:"settings"}))}catch(F){i("createIdentityProviderError",F)}};return d(v,{children:[e(G,{titleKey:t(c?"addKeycloakOpenIdProvider":"addOpenIdProvider")}),e(w,{variant:"light",children:e(L,{...o,children:d(z,{role:"manage-identity-providers",isHorizontal:!0,onSubmit:u(I),children:[e(K,{}),e($,{}),e(N,{}),d(j,{children:[e(f,{isDisabled:!y,variant:"primary",type:"submit","data-testid":"createProvider",children:t("add")}),e(f,{variant:"link","data-testid":"cancel",component:n=>e(T,{...n,to:U({realm:a})}),children:t("cancel")})]})]})})})]})}export{pe as default};
//# sourceMappingURL=AddOpenIdConnect-oOKjznGi.js.map
