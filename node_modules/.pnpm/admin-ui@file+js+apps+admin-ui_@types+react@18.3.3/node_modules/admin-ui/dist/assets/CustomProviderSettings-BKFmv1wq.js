import{jsxs as l,jsx as e}from"react/jsx-runtime";import{a as I,aj as V,F as U,ac as v,ad as b,ae as P,a4 as C,y as f,u as j,d as x,g as E,f as H,c as D,b as O,w as _,P as L,A as z,j as F,L as G,dY as k,S as R,l as q,Q as B}from"./main-DXDh8SEc.js";import{D as J}from"./DynamicComponents-oH6U-qv7.js";import{F as Q}from"./FormAccess-Bcw0IOUQ.js";import{u as W}from"./useParams-5577fL9S.js";import{E as Y}from"./ExtendedHeader-DISZMVW_.js";import{S as K}from"./SettingsCache-DQ1ndLIK.js";import"react";import"react-dom";import"./ClientSelect-DzH7E0lJ.js";import"./FileUpload-CK_LBb0x.js";import"./CodeEditor-BFrRAdAy.js";import"./copy-icon-C4kUIpk5.js";import"./EmptyStateFooter-C_ktbNPy.js";import"./EmptyStateActions-CiPKPOdJ.js";import"./GroupPickerDialog-B6DOUphD.js";import"./PaginatingTableToolbar-zbU1l_6-.js";import"./DataListItemRow-CavOLjhh.js";import"./FlexItem-c5qvFYFZ.js";import"./KeySelect-BIWWws15.js";import"./useToggle-K3Kx99tM.js";import"./MultiLineInput-D3_8dp6S.js";import"./AddRoleMappingModal-BqIKRo9T.js";import"./KeycloakDataTable-B3eTS_qk.js";import"./Td-BmSS9qQq.js";import"./grip-vertical-icon-CgFEKIXW.js";import"./_baseFlatten-CMLUuI8z.js";import"./ConfirmDialog-o8TAA2Kj.js";import"./filter-icon-Do5tIUfA.js";import"./ViewHeader-DTd0a4sz.js";import"./isEqual-DfpijAgC.js";const M=()=>{const{t:r}=I(),a=V(),{control:o,watch:t}=a,d=t("config.fullSyncPeriod","-1"),c=t("config.changedSyncPeriod","-1");return l(U,{...a,children:[e(v,{label:r("periodicFullSync"),labelIcon:e(b,{helpText:r("periodicFullSyncHelp"),fieldLabelId:"periodicFullSync"}),fieldId:"kc-periodic-full-sync",hasNoPaddingTop:!0,children:e(P,{name:"config.fullSyncPeriod",defaultValue:"-1",control:o,render:({field:n})=>e(C,{id:"kc-periodic-full-sync","data-testid":"periodic-full-sync",onChange:(m,s)=>{n.onChange(s?"604800":"-1")},isChecked:n.value!=="-1",label:r("on"),labelOff:r("off"),"aria-label":r("periodicFullSync")})})}),d!=="-1"&&e(f,{name:"config.fullSyncPeriod",label:r("fullSyncPeriod"),labelIcon:r("fullSyncPeriodHelp"),type:"number",min:-1,defaultValue:"604800"}),e(v,{label:r("periodicChangedUsersSync"),labelIcon:e(b,{helpText:r("periodicChangedUsersSyncHelp"),fieldLabelId:"periodicChangedUsersSync"}),fieldId:"kc-periodic-changed-users-sync",hasNoPaddingTop:!0,children:e(P,{name:"config.changedSyncPeriod",defaultValue:"-1",control:o,render:({field:n})=>e(C,{id:"kc-periodic-changed-users-sync","data-testid":"periodic-changed-users-sync",onChange:(m,s)=>{n.onChange(s?"86400":"-1")},isChecked:n.value!=="-1",label:r("on"),labelOff:r("off"),"aria-label":r("periodicChangedUsersSync")})})}),c!=="-1"&&e(f,{name:"config.changedSyncPeriod",label:r("changedUsersSyncPeriod"),labelIcon:r("changedUsersSyncHelp"),type:"number",min:-1,defaultValue:"86400"})]})};function Ae(){const{adminClient:r}=j(),{t:a}=I(),{id:o,providerId:t}=W(),d=x(),c=E({mode:"onChange"}),{reset:n,setValue:m,handleSubmit:s,formState:{isDirty:w}}=c,{addAlert:A,addError:T}=H(),{realm:y,realmRepresentation:N}=D(),g=(O().componentTypes?.["org.keycloak.storage.UserStorageProvider"]||[]).find(i=>i.id===t);_(async()=>{if(o)return await r.components.findOne({id:o})},i=>{if(i)B(i,m);else if(o)throw new Error(a("notFound"))},[]);const h=async i=>{const S=R({...i,config:Object.fromEntries(Object.entries(i.config||{}).map(([p,u])=>[p,Array.isArray(u)?u:[u]])),providerId:t,providerType:"org.keycloak.storage.UserStorageProvider",parentId:N?.id});try{o?await r.components.update({id:o},S):(await r.components.create(S),d(k({realm:y}))),n({...i}),A(a(o?"userProviderSaveSuccess":"createUserProviderSuccess"),q.success)}catch(p){T(o?"userProviderSaveError":"createUserProviderError",p)}};return l(U,{...c,children:[e(Y,{provider:t,save:()=>s(h)()}),e(L,{variant:"light",children:l(Q,{role:"manage-realm",isHorizontal:!0,className:"keycloak__user-federation__custom-form",onSubmit:s(h),children:[e(f,{name:"name",label:a("uiDisplayName"),labelIcon:a("uiDisplayNameHelp"),rules:{required:a("validateName")}}),e(J,{properties:g?.properties||[]}),g?.metadata.synchronizable&&e(M,{}),e(K,{form:c,unWrap:!0}),l(z,{children:[e(F,{isDisabled:!w,variant:"primary",type:"submit","data-testid":"custom-save",children:a("save")}),e(F,{variant:"link",component:i=>e(G,{...i,to:k({realm:y})}),"data-testid":"custom-cancel",children:a("cancel")})]})]})})]})}export{Ae as default};
//# sourceMappingURL=CustomProviderSettings-BKFmv1wq.js.map
